<!doctype html>
<html lang="es-ES" dir="ltr" class="docs-wrapper docs-doc-page docs-version-5.x plugin-docs plugin-id-default docs-doc-id-faq/migrating-from-ink-4-to-5">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Migrating from ink! 4.x to 5.0 | ink! documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://use.ink/es/5.x/faq/migrating-from-ink-4-to-5"><meta data-rh="true" name="docusaurus_locale" content="es"><meta data-rh="true" name="docsearch:language" content="es"><meta data-rh="true" name="docusaurus_version" content="5.x"><meta data-rh="true" name="docusaurus_tag" content="docs-default-5.x"><meta data-rh="true" name="docsearch:version" content="5.x"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-5.x"><meta data-rh="true" property="og:title" content="Migrating from ink! 4.x to 5.0 | ink! documentation"><meta data-rh="true" name="description" content="We&#x27;ve made a couple of breaking changes from ink! 4.x to ink! 5.0."><meta data-rh="true" property="og:description" content="We&#x27;ve made a couple of breaking changes from ink! 4.x to ink! 5.0."><link data-rh="true" rel="icon" href="/es/img/favicon.png"><link data-rh="true" rel="canonical" href="https://use.ink/es/5.x/faq/migrating-from-ink-4-to-5"><link data-rh="true" rel="alternate" href="https://use.ink/5.x/faq/migrating-from-ink-4-to-5" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://use.ink/es/5.x/faq/migrating-from-ink-4-to-5" hreflang="es-ES"><link data-rh="true" rel="alternate" href="https://use.ink/5.x/faq/migrating-from-ink-4-to-5" hreflang="x-default"><link rel="stylesheet" href="fonts/fonts.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Montserrat:wght@400;500;700&display=swap">
<script src="https://apisa.parity.io/latest.js" defer="defer"></script><link rel="stylesheet" href="/es/assets/css/styles.9dcd6fba.css">
<link rel="preload" href="/es/assets/js/runtime~main.592b5be2.js" as="script">
<link rel="preload" href="/es/assets/js/main.3411f81b.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Saltar al contenido principal"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Saltar al contenido principal</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/es/"><div class="navbar__logo"><img src="/es/img/text-black.svg" alt="ink!" class="themedImage_ToTc themedImage--light_HNdA"><img src="/es/img/text-white.svg" alt="ink!" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/es/5.x/">5.0-rc</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/es/">4.x</a></li><li><a class="dropdown__link" href="/es/3.x/">3.x</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/es/5.x/faq/migrating-from-ink-4-to-5">5.0-rc</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">La lengua</a><ul class="dropdown__menu"><li><a class="dropdown__link" target="_parent" href="/es/5.x/">Inglés</a></li><li><a class="dropdown__link" target="_parent" href="/es/">Español</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Volver al principio" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/es/5.x/">Overview</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/es/5.x/getting-started/setup">Getting started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/es/5.x/basics/contract-template">Basics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/es/5.x/basics/contract-testing/overview">Testing &amp; Debugging</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/es/5.x/macros-attributes">Macros &amp; Attributes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/es/5.x/datastructures/overview">Storage &amp; Data Structures</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/es/5.x/linter/overview">Linter</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/es/5.x/frontend/overview">Frontend Development</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/es/5.x/examples/smart-contracts">Examples</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/es/5.x/standards/overview">Standards</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/es/5.x/funding-programs">Funding Programs</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/es/5.x/testnet">Testnet</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/es/5.x/getting-started/use-openbrush">Third Party Tools &amp; Libraries</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/es/5.x/faq">FAQ</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/es/5.x/faq">Preguntas Frequentes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/es/5.x/faq/migrating-from-ink-4-to-5">Migrating from ink! 4.x to 5.0</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/es/5.x/faq/migrating-from-ink-3-to-4">Migrating from ink! 3.x to 4.0</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/es/5.x/brand-assets/ink">Brand Assets</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/es/"><svg id="prefix__Layer_1" xmlns="http://www.w3.org/2000/svg" x="0" y="0" viewBox="0 0 75 73.3" style="enable-background:new 0 0 75 73.3" xml:space="preserve" role="img" class="breadcrumbHomeIcon_YNFT"><style>.prefix__st0{opacity:.75}.prefix__st1{fill-rule:evenodd;clip-rule:evenodd;fill:#e3e3e3}.prefix__st2{fill:#fff}</style><g class="prefix__st0"><path class="prefix__st1" d="M6.9 47.1h2.4c8.8-26.7-22.6-20.4-2.4 0z"></path></g><g class="prefix__st0"><path class="prefix__st1" d="M6.9 49.1h2.4c8.8 26.7-22.6 20.4-2.4 0z"></path></g><g class="prefix__st0"><path class="prefix__st2" d="M12.2 50.6H5.1c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5h7.1c1.4 0 2.5 1.1 2.5 2.5s-1.1 2.5-2.5 2.5z"></path></g><g class="prefix__st0"><path class="prefix__st1" d="M37.4 19.7V5.9C37.4 2.7 40 0 43.3 0h11.9v10.7h-4.7c-1.2 0-2.2 1-2.2 2.2v6.7l-10.9.1z"></path></g><path d="m58.5 31.2-1.2-9.4c-.2-1.7-1.7-3-3.4-3H33.3c-1.7 0-3.2 1.3-3.4 3l-1.2 9.4h29.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#fff" class="prefix__st0"></path><g class="prefix__st0"><path class="prefix__st1" d="M43.6 22.9c-17.4 0-31.4 11.3-31.4 25.2s14.1 25.2 31.4 25.2S75 62 75 48.1 60.9 22.9 43.6 22.9zm0 36.5c-6.6 0-11.9-5.3-11.9-11.9S37 35.6 43.6 35.6 55.5 41 55.5 47.5s-5.4 11.9-11.9 11.9z"></path></g><path d="M38 52.8c-.6 0-1.3-.2-1.8-.7-1-1-1-2.6 0-3.5l8.4-8.4c1-1 2.6-1 3.5 0 1 1 1 2.6 0 3.5l-8.4 8.4c-.4.5-1 .7-1.7.7z" style="fill:#e3e3e3" class="prefix__st0"></path><g class="prefix__st0"><path class="prefix__st2" d="M43.6 63.7c-8.9 0-16.2-7.3-16.2-16.2s7.3-16.2 16.2-16.2 16.2 7.3 16.2 16.2-7.3 16.2-16.2 16.2zm0-27.3c-6.2 0-11.2 5-11.2 11.2s5 11.2 11.2 11.2 11.2-5 11.2-11.2-5.1-11.2-11.2-11.2z"></path></g><g class="prefix__st0"><path class="prefix__st2" d="M52.8 0h5v10.7h-5z"></path></g></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">FAQ</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Migrating from ink! 4.x to 5.0</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 5.0-rc</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">En esta página</button></div><div class="theme-doc-markdown markdown"><header><h1>Migrating from ink! 4.x to 5.0</h1></header><img loading="lazy" src="/img/title/migration-4.x-to-5.0.svg" class="titlePic img_ev3q"><p>We&#x27;ve made a couple of breaking changes from ink! 4.x to ink! 5.0.
On this page we outline how you can migrate existing clients and
contracts from 4.x to 5.0.</p><p>This release addresses the majority of issues raised in <a href="https://blog.openzeppelin.com/security-review-ink-cargo-contract" target="_blank" rel="noopener noreferrer">the OpenZeppelin
security review</a>.
In particular, we addressed the proxy selector clashing attack.</p><p>You can find the full changelog of the 5.0 release <a href="https://github.com/paritytech/ink/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer">here</a>.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>This migration guide only considers your code base! Not your storage data!</p><p>If you have an existing contract on-chain you might not be able to just
upgrade the code on-chain, you possibly also have to migrate your storage data.</p><p>The relevant change that you have to take into consideration is
<a href="https://github.com/paritytech/ink/pull/1897" target="_blank" rel="noopener noreferrer">#1897</a>.
A data migration may be required when your contract reads data from storage and truncates
the data when decoding it.
We&#x27;ve described this in more detail below, in the section
<a href="#fail-when-decoding-from-storage-and-not-all-bytes-consumed">&quot;Fail when decoding from storage and not all bytes consumed&quot;</a>.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-upgrade">How to upgrade<a href="#how-to-upgrade" class="hash-link" aria-label="Enlace directo al How to upgrade" title="Enlace directo al How to upgrade">​</a></h2><ul><li>Change the dependency versions of <code>ink</code> and <code>ink_e2e</code> in your contracts <code>Cargo.toml</code> to <code>5</code>.</li><li>Update your local <code>cargo-contract</code> installation to 4.0.</li><li>Read through this page.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="compatibility">Compatibility<a href="#compatibility" class="hash-link" aria-label="Enlace directo al Compatibility" title="Enlace directo al Compatibility">​</a></h2><p>The following chains are in production and support ink! 5.0:</p><div class="row"><div class="col text--center"><a href="https://alephzero.org" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="/img/chains/aleph-zero.svg" class="chain img_ev3q"></a></div><div class="col text--center"><a href="https://astar.network" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="/img/chains/astar.svg" class="chain img_ev3q"></a></div><div class="col text--center"><a href="https://shiden.astar.network" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="/img/chains/shiden.svg" class="chain img_ev3q"></a></div></div><div class="row"><div class="col text--center"><a href="http://phala.network" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="/img/chains/phala.svg" class="chain img_ev3q"></a></div><div class="col text--center"><a href="https://pendulumchain.org" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="/img/chains/pendulum.svg" class="chain img_ev3q"></a></div><div class="col text--center"><a href="https://pendulumchain.org/amplitude" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="/img/chains/amplitude.svg" class="chain img_ev3q"></a></div></div><div class="row"><div class="col text--center"><a href="https://krest.peaq.network/" target="_blank" rel="noopener noreferrer"><img loading="lazy" src="/img/chains/krest.svg" class="chain img_ev3q"></a></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cargo-contract-40"><code>cargo-contract</code> 4.0<a href="#cargo-contract-40" class="hash-link" aria-label="Enlace directo al cargo-contract-40" title="Enlace directo al cargo-contract-40">​</a></h3><p>Together with ink! 5.0 we&#x27;ve released <code>cargo-contract</code> 4.0.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 75 75" xmlns="http://www.w3.org/2000/svg"><style>.st1{fill:#bc83fb}.st4{fill:#d8b7fb}</style><ellipse transform="rotate(-45.001 37.501 37.497)" cx="37.5" cy="37.5" rx="38.92" ry="36.03" style="fill:#fff"></ellipse><path class="st1" d="M34.56 50.4s3.56 4.75 9.4-1.47c3.71-3.94 6.78-4.02 7.19-1.17.51 3.54-5.11 12.97-13.43 12.97L34.56 50.4z"></path><path class="st1" d="M37.5 66.74c-15.46 0-28.04-12.58-28.04-28.04 0-9.82 5-18.76 13.38-23.91.89-.55 2.05-.27 2.59.62.55.89.27 2.05-.62 2.59-7.25 4.46-11.58 12.19-11.58 20.7 0 13.38 10.89 24.27 24.27 24.27S61.77 52.08 61.77 38.7c0-8.5-4.33-16.24-11.58-20.69a1.886 1.886 0 0 1-.62-2.59c.55-.89 1.71-1.16 2.59-.62 8.38 5.15 13.38 14.09 13.38 23.91 0 15.44-12.58 28.03-28.04 28.03z"></path><path d="M37.5 60.73c-3.55 0-6.46-2.91-6.46-6.46V29.56c0-3.55 2.91-6.46 6.46-6.46s6.46 2.91 6.46 6.46v24.71c0 3.55-2.91 6.46-6.46 6.46z" style="fill:#8747cc"></path><ellipse transform="rotate(-76.761 37.496 13.816)" cx="37.49" cy="13.82" rx="5.51" ry="6.18" style="fill-rule:evenodd;clip-rule:evenodd;fill:#bc83fb"></ellipse><ellipse class="st4" transform="rotate(-84.393 37.253 51.863)" cx="37.25" cy="51.86" rx="3.54" ry="2.4"></ellipse><ellipse class="st4" transform="rotate(-84.393 37.25 39.353)" cx="37.25" cy="39.35" rx="4.39" ry="2.97"></ellipse><path class="st1" d="M43.96 29.55v7.86c0-4.78-2.03-7.84-5.29-7.75-2.38.06-5.25 3.51-7.63 6.05-3.7 3.95-6.78 3.22-7.18.37-.5-3.47 5.11-12.6 13.17-12.95.15-.01.31-.02.46-.02h.02c3.55 0 6.45 2.89 6.45 6.44z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>You have to use <code>cargo-contract</code> &gt;= 4.0 for ink! 5.0 contracts!</p><p>You can upgrade via:</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token plain">cargo install cargo</span><span class="token operator" style="color:#e09142">-</span><span class="token plain">contract </span><span class="token operator" style="color:#e09142">-</span><span class="token operator" style="color:#e09142">-</span><span class="token plain">version </span><span class="token operator" style="color:#e09142">^</span><span class="token number" style="color:#e09142">4</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código al portapapeles" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div><p>Make sure that e.g. your CI also uses at least <code>cargo-contract</code> 4.0 with ink! v5.0.
If you have wrapper scripts around <code>cargo-contract</code>, you should
ensure that this version is enforced, otherwise users will get an error.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="substrate">Substrate<a href="#substrate" class="hash-link" aria-label="Enlace directo al Substrate" title="Enlace directo al Substrate">​</a></h3><p>The same requirements as for ink! 4.0 hold.</p><ul><li><code>pallet-contracts</code> &gt;= <code>polkadot-v0.9.37</code>.</li><li><code>substrate-contracts-node</code> &gt;= <code>v0.24.0</code></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="how-do-i-find-out-which-polkadot-version-a-chain-is-running-on">How do I find out which Polkadot version a chain is running on?<a href="#how-do-i-find-out-which-polkadot-version-a-chain-is-running-on" class="hash-link" aria-label="Enlace directo al How do I find out which Polkadot version a chain is running on?" title="Enlace directo al How do I find out which Polkadot version a chain is running on?">​</a></h4><p>You can query the <code>contracts::palletVersion()</code> via the chain state RPCs. It has to
be <code>&gt;= 9</code> for ink! 5.0 to be compatible.</p><p>You can use e.g. the <a href="https://polkadot.js.org/apps/" target="_blank" rel="noopener noreferrer">polakdot.js app</a> to do this:
Developer » Chain State » <code>contracts</code> » <code>palletVersion()</code> » Click on the <code>+</code> on the right.</p><img loading="lazy" src="/img/pallet-version.png" class="img_ev3q"><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tooling">Tooling<a href="#tooling" class="hash-link" aria-label="Enlace directo al Tooling" title="Enlace directo al Tooling">​</a></h3><ul><li><code>cargo-contract</code> &gt;= v4.0</li><li>Stable Rust &gt;= 1.75</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="dependencies">Dependencies<a href="#dependencies" class="hash-link" aria-label="Enlace directo al Dependencies" title="Enlace directo al Dependencies">​</a></h3><p>Same as for ink! 4.0.</p><ul><li><code>scale</code> &gt;= 3</li><li><code>scale-info</code> &gt;= 2.6</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="frontend-libraries">Frontend Libraries<a href="#frontend-libraries" class="hash-link" aria-label="Enlace directo al Frontend Libraries" title="Enlace directo al Frontend Libraries">​</a></h3><p>Same as for ink! 4.0: <code>polkadot-js/api</code> and <code>polkadot-js/api-contract</code> &gt;= 9.10.2.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="important-changes">Important Changes<a href="#important-changes" class="hash-link" aria-label="Enlace directo al Important Changes" title="Enlace directo al Important Changes">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="scale-dependencies-were-moved-to-ink-entrance-crate"><code>scale</code> dependencies were moved to <code>ink</code> entrance crate<a href="#scale-dependencies-were-moved-to-ink-entrance-crate" class="hash-link" aria-label="Enlace directo al scale-dependencies-were-moved-to-ink-entrance-crate" title="Enlace directo al scale-dependencies-were-moved-to-ink-entrance-crate">​</a></h3><p>This change was done to ensure that you always use the correct scale dependency versions
with an ink! version. The relevant PR is <a href="https://github.com/paritytech/ink/pull/1890" target="_blank" rel="noopener noreferrer">#1890</a>.</p><p>We removed the requirement for contracts to have direct dependencies on <code>parity-scale-codec</code>
and <code>scale-info</code> in their <code>Cargo.toml</code>.
You can now remove those dependencies from your contracts <code>Cargo.toml</code>:</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token plain">ink = { version = &quot;4.3&quot;, default-features = false }</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token deleted-sign deleted prefix deleted" style="text-decoration-line:line-through">-</span><span class="token deleted-sign deleted line" style="text-decoration-line:line-through">scale = { package = &quot;parity-scale-codec&quot;, version = &quot;3&quot;, default-features = false, features = [&quot;derive&quot;] }</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token deleted-sign deleted line" style="text-decoration-line:line-through"></span><span class="token deleted-sign deleted prefix deleted" style="text-decoration-line:line-through">-</span><span class="token deleted-sign deleted line" style="text-decoration-line:line-through">scale-info = { version = &quot;2.6&quot;, default-features = false, features = [&quot;derive&quot;], optional = true }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código al portapapeles" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Both crates have been re-exported from the <code>ink</code> umbrella crate: <code>ink::scale_info</code> and <code>ink::scale</code>.</p><p>We created a convenience macro to derive the re-exported traits <code>ink::scale::Encode</code>,
<code>ink::scale::Decode</code> and <code>ink::scale_info::TypeInfo</code>.</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token comment" style="color:#6c6783">// Previously</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token attribute attr-name" style="color:#c4b9fe">#[scale::Encode, scale::Decode)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token attribute attr-name" style="color:#c4b9fe">#[cfg_attr(feature = </span><span class="token attribute attr-name string" style="color:#ffcc99">&quot;std&quot;</span><span class="token attribute attr-name" style="color:#c4b9fe">, derive(::scale_info::TypeInfo))]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">enum</span><span class="token plain"> </span><span class="token type-definition class-name">Error</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">// Now</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink::scale_derive(Encode, Decode, TypeInfo)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">enum</span><span class="token plain"> </span><span class="token type-definition class-name">Error</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código al portapapeles" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The documentation of the macro can be found <a href="https://docs.rs/ink/5.0.0-rc/ink/attr.scale_derive.html" target="_blank" rel="noopener noreferrer">here</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="wildcard-selectors-only-one-other-message-is-allowed-in-the-contract-besides-the-wildcard-selector">Wildcard selectors: only one other message is allowed in the contract besides the wildcard selector<a href="#wildcard-selectors-only-one-other-message-is-allowed-in-the-contract-besides-the-wildcard-selector" class="hash-link" aria-label="Enlace directo al Wildcard selectors: only one other message is allowed in the contract besides the wildcard selector" title="Enlace directo al Wildcard selectors: only one other message is allowed in the contract besides the wildcard selector">​</a></h3><p>Following <a href="https://blog.openzeppelin.com/security-review-ink-cargo-contract" target="_blank" rel="noopener noreferrer">our security review by OpenZeppelin</a>,
we&#x27;ve tightened the usage of wildcard selectors.
With ink! 5.0 we allow only exactly one other contract message with a well-known reserved
selector to be defined. In ink! 4.x, more than one other message was allowed.</p><p>Read more in <a href="https://github.com/paritytech/ink/pull/1708" target="_blank" rel="noopener noreferrer">the PR</a> and <a href="https://github.com/paritytech/ink/issues/1676" target="_blank" rel="noopener noreferrer">IIP-2: Limit contracts with a wildcard selector to one other message</a>.</p><p>The proposal is to restrict contracts with a wildcard selector to only have one other message
with a reserved/well-known selector. This guarantees that there are no selector clashes,
either by chance or malicious intent, and that the Proxy will only handle messages intended for it.</p><p>If a contract uses a wildcard selector <code>#[ink(message, payable, selector = _)]</code> it <em>MAY</em> define one
other message. This message <em>MUST</em> use the reserved selector <code>@</code>.
This selector <em>MUST</em> only be used in conjunction with a wildcard selector.</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token comment" style="color:#6c6783">/// Handles any message with no matching selector in this proxy contract</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(message, selector = _)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">fallback</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// forward call to the &quot;logic&quot; contract which actually executes the call</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink::scale_derive(Decode)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">enum</span><span class="token plain"> </span><span class="token type-definition class-name">ProxyMessage</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token class-name">UpgradeContract</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">Hash</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// One other message allowed to handle messages.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// Fails to compile unless `@` is used as the selector.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token attribute attr-name" style="color:#c4b9fe">#[ink(message, selector = @)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">handler</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">ProxyMessage</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">match</span><span class="token plain"> msg </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token class-name">ProxyMessage</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">hash</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// An additional message. Fails to compile when uncommented.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">// #[ink(message)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">// pub fn additional_message(&amp;self, msg: ProxyMessage) {</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">//    match msg {</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">//        ProxyMessage(hash) =&gt; ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">//    }</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">// }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código al portapapeles" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="events-20">Events 2.0<a href="#events-20" class="hash-link" aria-label="Enlace directo al Events 2.0" title="Enlace directo al Events 2.0">​</a></h3><p>In prior ink! versions, events were defined inside the <code>#[ink::contract]</code> macro.
With ink! 5.0 we decouple events from the <code>#[ink::contract]</code> macro,
allowing events to be shared between contracts.
We&#x27;ve updated <a href="/es/5.x/basics/events">the Events documentation page</a> accordingly.</p><p>The syntax of defining events within the main <code>#[ink::contract]</code> macro will continue to work,
no code changes in existing contracts are required to update to the new syntax.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>The topic calculation changed in general, so also for events that are declared inside the
<code>#[ink::contract]</code> macro!</p><p>This is a breaking change for any client code which uses topics to filter events.</p><p>Please see <a href="https://github.com/paritytech/ink/pull/1827" target="_blank" rel="noopener noreferrer">#1827</a> for details.</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="custom-signature-topics">Custom signature topics<a href="#custom-signature-topics" class="hash-link" aria-label="Enlace directo al Custom signature topics" title="Enlace directo al Custom signature topics">​</a></h4><p>In <a href="https://github.com/paritytech/ink/pull/2031" target="_blank" rel="noopener noreferrer">#2031</a> we introduced an
optional attribute <code>signature_topic</code> to the <code>#[ink::event]</code> and <code>#[ink(event)]</code> macros.
It can be used to specify the signature topic for a specific event manually, instead of the
automatic topic calculation.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="no-more-unchecked-arithmetic">No more unchecked arithmetic<a href="#no-more-unchecked-arithmetic" class="hash-link" aria-label="Enlace directo al No more unchecked arithmetic" title="Enlace directo al No more unchecked arithmetic">​</a></h3><p>Unchecked arithmetic operations in a contract are no longer supported for arithmetic
safety reasons. Compiling a contract that contains those will fail gracefully.</p><p>If you haven&#x27;t already done, you now need to handle overflows that could occur.
Rust supports different possibilities of doing so (saturating, &quot;wrap around&quot;,
and unchecked arithmetic operations) .
See <a href="https://doc.rust-lang.org/book/ch03-02-data-types.html#scalar-types" target="_blank" rel="noopener noreferrer">this</a> section
of the Rust Programming Language for a thorough explanation on how to do safe arithmetic
operations in Rust.</p><p>This change was introduced in <a href="https://github.com/paritytech/ink/pull/1831" target="_blank" rel="noopener noreferrer">#1831</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fail-when-decoding-from-storage-and-not-all-bytes-consumed">Fail when decoding from storage and not all bytes consumed<a href="#fail-when-decoding-from-storage-and-not-all-bytes-consumed" class="hash-link" aria-label="Enlace directo al Fail when decoding from storage and not all bytes consumed" title="Enlace directo al Fail when decoding from storage and not all bytes consumed">​</a></h3><p>If a contract previously relied on successful decoding which does not consume all bytes,
then recompiling with a version of ink! which includes this change will cause that contract
to trap at runtime when attempting to decode.</p><p>A simple example would be if a storage cell contains some bytes which were in the first place
an encoded <code>u32</code>. If the contract attempts to decode those into a <code>u8</code>
this would previously have succeeded, now the contract would trap.</p><p>Here&#x27;s a code example of behavior that previously worked for ink! 4.x, but
would error now:</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> key </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0u32</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> value </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token number" style="color:#e09142">0x42</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token number" style="color:#e09142">32</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token namespace" style="opacity:0.7">ink</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token function" style="color:#9a86fd">set_contract_storage</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token plain">value</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">// Only attempt to read the first byte (the `u8`) of the storage value data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> _loaded_value</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">Option</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">ink</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token function" style="color:#9a86fd">get_contract_storage</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">map_err</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token closure-params closure-punctuation punctuation" style="color:#6c6783">|</span><span class="token closure-params">e</span><span class="token closure-params closure-punctuation punctuation" style="color:#6c6783">|</span><span class="token plain"> </span><span class="token macro property" style="color:#9a86fd">format!</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;get_contract_storage failed: {:?}&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> e</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token operator" style="color:#e09142">?</span><span class="token punctuation" style="color:#6c6783">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código al portapapeles" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We introduced this change in <a href="https://github.com/paritytech/ink/pull/1897" target="_blank" rel="noopener noreferrer">#1897</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ink_e2e-api-changes">[ink_e2e]<!-- --> API Changes<a href="#ink_e2e-api-changes" class="hash-link" aria-label="Enlace directo al ink_e2e-api-changes" title="Enlace directo al ink_e2e-api-changes">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="builder-api">Builder API<a href="#builder-api" class="hash-link" aria-label="Enlace directo al Builder API" title="Enlace directo al Builder API">​</a></h4><p>In <a href="https://github.com/paritytech/ink/pull/1917" target="_blank" rel="noopener noreferrer">#1917</a> we reworked the E2E API with
a builder API.
<code>instantiate</code>, <code>call</code> and <code>upload</code> will now return a builder instance. You can
specify optional arguments with builder methods, and submit the call for on-chain
execution with the <code>.submit()</code> method, or dry-run it with <code>dry_run()</code>.</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> contract </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> client</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">instantiate</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;flipper&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token namespace" style="opacity:0.7">ink_e2e</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token function" style="color:#9a86fd">alice</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token keyword" style="color:#ffcc99">mut</span><span class="token plain"> constructor</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">submit</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token keyword" style="color:#ffcc99">await</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">expect</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;instantiate failed&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">mut</span><span class="token plain"> call </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> contract</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">call</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">Flipper</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> get </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> call</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">get</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> get_res </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">call</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token namespace" style="opacity:0.7">ink_e2e</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token function" style="color:#9a86fd">bob</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;</span><span class="token plain">get</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">dry_run</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token keyword" style="color:#ffcc99">await</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token macro property" style="color:#9a86fd">assert!</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token macro property" style="color:#9a86fd">matches!</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">get_res</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">return_value</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código al portapapeles" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="extra-gas-margin">Extra gas margin<a href="#extra-gas-margin" class="hash-link" aria-label="Enlace directo al Extra gas margin" title="Enlace directo al Extra gas margin">​</a></h4><p>As part of <a href="https://github.com/paritytech/ink/pull/1917" target="_blank" rel="noopener noreferrer">#1917</a> we added the possibility
to specify a gas margin (in percentage) as part of the on-chain call.</p><p>There are cases when gas estimates may not necessarily be accurate enough due to the complexity
of the smart contract logic that adds additional overhead and gas consumption.
Therefore, it is helpful to allow to specify an extra portion of the gas to be added to the
limit (i.e. 5%, 10%).</p><p>The method <code>.extra_gas_portion(margin: u64)</code> method is part of the builder API:</p><ul><li><a href="https://docs.rs/ink_e2e/5.0.0-rc/ink_e2e/struct.InstantiateBuilder.html#method.extra_gas_portion" target="_blank" rel="noopener noreferrer"><code>ink_e2e::InstantiateBuilder::extra_gas_portion</code></a></li><li><a href="https://docs.rs/ink_e2e/5.0.0-rc/ink_e2e/struct.CallBuilder.html#method.extra_gas_portion" target="_blank" rel="noopener noreferrer"><code>ink_e2e::CallBuilder::extra_gas_portion</code></a></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="improved-call-api">Improved <code>call()</code> API<a href="#improved-call-api" class="hash-link" aria-label="Enlace directo al improved-call-api" title="Enlace directo al improved-call-api">​</a></h4><p>We removed the <code>build_message()</code> function with its unhandy callback.</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token comment" style="color:#6c6783">// Previously</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> first_insert </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">ink_e2e</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token function" style="color:#9a86fd">build_message</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">MappingsRef</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">contract_id</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">call</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token closure-params closure-punctuation punctuation" style="color:#6c6783">|</span><span class="token closure-params">contract</span><span class="token closure-params closure-punctuation punctuation" style="color:#6c6783">|</span><span class="token plain"> contract</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">insert_balance</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token number" style="color:#e09142">1_000</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">// Now</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">let</span><span class="token plain"> first_insert </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">ink_e2e</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token function" style="color:#9a86fd">build_message</span><span class="token punctuation" style="color:#6c6783">::</span><span class="token operator" style="color:#e09142">&lt;</span><span class="token class-name">MappingsRef</span><span class="token operator" style="color:#e09142">&gt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">contract_id</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">call</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">insert_balance</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token number" style="color:#e09142">1_000</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código al portapapeles" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>See <a href="https://github.com/paritytech/ink/pull/1782" target="_blank" rel="noopener noreferrer">#1782</a> for more details.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="new-data-structure-storagevec">New Data Structure: <code>StorageVec</code><a href="#new-data-structure-storagevec" class="hash-link" aria-label="Enlace directo al new-data-structure-storagevec" title="Enlace directo al new-data-structure-storagevec">​</a></h3><p>We&#x27;ve added a <code>Vec</code>-like data structure, built on top of Mapping.</p><p>This allows to retrieve elements from a vector and grow it without
having to load and push all elements.
For <code>Vec</code>, the cost of reading or writing a single element grows linearly corresponding
to the number of elements in the vector (its length). Additionally, the maximum capacity
of the whole vector is limited by the size of <a href="https://github.com/paritytech/ink/blob/master/ARCHITECTURE.md#communication-with-the-pallet" target="_blank" rel="noopener noreferrer">ink!&#x27;s static buffer</a>
used during ABI encoding and decoding (default 16 KiB).
<code>StorageVec</code> on the other hand allows to access each element individually.</p><p>With a <code>Vec</code> it&#x27;s possible to e.g. introduce a security issue in your contract
where an attacker can fill the <code>Vec</code>, making it very costly for other users to
access it or write to it.</p><p>You can find verbatim documentation on <code>StorageVec</code> <a href="/es/5.x/datastructures/storagevec">here</a>.
The page explains when to use <code>StorageVec</code> and when not.
The Rust docs can be found <a href="https://docs.rs/ink/5.0.0-rc/ink/storage/struct.StorageVec.html" target="_blank" rel="noopener noreferrer">here</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fallible-methods-for-lazy-mapping-storagevec">Fallible methods for <code>Lazy</code>, <code>Mapping</code>, <code>StorageVec</code><a href="#fallible-methods-for-lazy-mapping-storagevec" class="hash-link" aria-label="Enlace directo al fallible-methods-for-lazy-mapping-storagevec" title="Enlace directo al fallible-methods-for-lazy-mapping-storagevec">​</a></h3><p>In <a href="https://github.com/paritytech/ink/pull/1910" target="_blank" rel="noopener noreferrer">#1910</a> we added <code>try_*</code> methods for
reading and writing <code>Lazy</code> and <code>Mapping</code> values to and from storage.
The try methods correspond to <code>Mapping::{insert, get, take}</code>, <code>Lazy::{set, get}</code>.
For <code>StorageVec::{peek, get, set, pop, push}</code> we added <code>try_*</code> methods in
<a href="https://github.com/paritytech/ink/pull/1995" target="_blank" rel="noopener noreferrer">#1995</a>.</p><p>Please see the individual Rust docs for these new methods:</p><ul><li><a href="https://docs.rs/ink/5.0.0-rc/ink/storage/struct.StorageVec.html" target="_blank" rel="noopener noreferrer"><code>StorageVec</code></a></li><li><a href="https://docs.rs/ink/5.0.0-rc/ink/storage/struct.Lazy.html" target="_blank" rel="noopener noreferrer"><code>Lazy</code></a></li><li><a href="https://docs.rs/ink/5.0.0-rc/ink/storage/struct.Mapping.html" target="_blank" rel="noopener noreferrer"><code>Mapping</code></a>. For <code>Mapping</code>, the encoded size of the key is also accounted for.</li></ul><p>You should use the <code>try_*</code> methods for dynamically sized values, unless you made sure
otherwise they will fit into the static buffer. The <a href="https://github.com/paritytech/ink/blob/master/ARCHITECTURE.md#communication-with-the-pallet" target="_blank" rel="noopener noreferrer">static buffer in ink!</a>
is 16 kB by default.</p><p>We added a lint to <code>cargo-contract</code> 4.0 that will detect
potentially unsafe uses of methods for which there are safer alternatives:
<a href="https://use.ink/5.x/linter/rules/non_fallible_api" target="_blank" rel="noopener noreferrer"><code>non_fallible_api</code></a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="chain-extension-api-changed--support-for-multiple-chain-extensions">Chain Extension API changed + Support for multiple chain extensions<a href="#chain-extension-api-changed--support-for-multiple-chain-extensions" class="hash-link" aria-label="Enlace directo al Chain Extension API changed + Support for multiple chain extensions" title="Enlace directo al Chain Extension API changed + Support for multiple chain extensions">​</a></h3><p>With <a href="https://github.com/paritytech/ink/pull/1958" target="_blank" rel="noopener noreferrer">#1958</a> we added support for interacting with
multiple chain extensions from ink!. This is a breaking change.</p><p>You can now e.g. have a contract that utilizes a PSP22 chain extension together with one
for random numbers.</p><p>The syntax for chain extensions changed slightly:</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token deleted-sign deleted prefix deleted" style="text-decoration-line:line-through">-</span><span class="token deleted-sign deleted line" style="text-decoration-line:line-through">#[ink(extension = 0xfecb)]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token deleted-sign deleted line" style="text-decoration-line:line-through"></span><span class="token inserted-sign inserted prefix inserted" style="text-decoration-line:underline">+</span><span class="token inserted-sign inserted line" style="text-decoration-line:underline">#[ink(function = 0xfecb)]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token inserted-sign inserted line" style="text-decoration-line:underline"></span><span class="token plain">fn foo() {}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código al portapapeles" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The argument type changed from <code>u32</code> to <code>u16</code>:</p><div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token deleted-sign deleted prefix deleted" style="text-decoration-line:line-through">-</span><span class="token deleted-sign deleted line" style="text-decoration-line:line-through">/// `#[ink(extension = N: u32)]`</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token deleted-sign deleted line" style="text-decoration-line:line-through"></span><span class="token deleted-sign deleted prefix deleted" style="text-decoration-line:line-through">-</span><span class="token deleted-sign deleted line" style="text-decoration-line:line-through">Extension,</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token deleted-sign deleted line" style="text-decoration-line:line-through"></span><span class="token inserted-sign inserted prefix inserted" style="text-decoration-line:underline">+</span><span class="token inserted-sign inserted line" style="text-decoration-line:underline">/// `#[ink(function = N: u16)]`</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token inserted-sign inserted line" style="text-decoration-line:underline"></span><span class="token inserted-sign inserted prefix inserted" style="text-decoration-line:underline">+</span><span class="token inserted-sign inserted line" style="text-decoration-line:underline">Function,</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código al portapapeles" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>A migration in most cases should just be to rename <code>#[ink(extension = …)]</code> to
<code>#[ink(function = …)]</code>.</p><p>We added an example contract that illustrates the usage of multiple chain extensions
in one contract:
<a href="https://github.com/paritytech/ink/tree/master/integration-tests/combined-extension" target="_blank" rel="noopener noreferrer"><code>combined-extension</code></a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="interesting-new-features">Interesting New Features<a href="#interesting-new-features" class="hash-link" aria-label="Enlace directo al Interesting New Features" title="Enlace directo al Interesting New Features">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="end-to-end-testing-with-a-chain-snapshot">End-To-End testing with a chain snapshot<a href="#end-to-end-testing-with-a-chain-snapshot" class="hash-link" aria-label="Enlace directo al End-To-End testing with a chain snapshot" title="Enlace directo al End-To-End testing with a chain snapshot">​</a></h3><p>With ink! 5.0 we introduce the possibility of running your tests against the
fork (i.e. snapshot) of a live chain.</p><p>See <a href="/es/5.x/basics/contract-testing/chain-snapshot">this page</a> in our documentation for details.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="new-lints">New lints<a href="#new-lints" class="hash-link" aria-label="Enlace directo al New lints" title="Enlace directo al New lints">​</a></h3><p>The new lints are:</p><ul><li><a href="/es/5.x/linter/rules/no_main"><code>no_main</code></a>: enforces <code>no_main</code> for  contracts.</li><li><a href="/es/5.x/linter/rules/primitive_topic"><code>primitive_topic</code></a>: no number types are allowed as event topics.</li><li><a href="/es/5.x/linter/rules/storage_never_freed"><code>storage_never_freed</code></a>: what is written into storage can be removed again.</li><li><a href="/es/5.x/linter/rules/strict_balance_equality"><code>strict_balance_equality</code></a>: detects usage of strict balance equality checks, a common smart contract vulnerability.</li><li><a href="/es/5.x/linter/rules/non_fallible_api"><code>non_fallible_api</code></a>: detects the usage of potentially unsafe methods for which there are safer alternatives.</li></ul><p>With <code>cargo-contract</code> 4.0 we added a couple new lints for common smart contract issues
and best practices.
You can run the linter via <code>cargo contract build --lint</code>.</p><p>Details on each lint can be found <a href="/es/5.x/linter/overview">here</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="new-cargo-contract-commands">New <code>cargo-contract</code> commands<a href="#new-cargo-contract-commands" class="hash-link" aria-label="Enlace directo al new-cargo-contract-commands" title="Enlace directo al new-cargo-contract-commands">​</a></h3><p>We added a bunch of helpful new commands to <code>cargo-contract</code> 4.0.
For all these commands you can also supply the <code>--help</code> cli flag to get more
info (e.g. <code>cargo contract storage --help</code>).</p><ul><li><code>cargo contract verify</code>: contract verification (<a href="https://github.com/paritytech/cargo-contract/pull/1404" target="_blank" rel="noopener noreferrer">#1404</a>, <a href="https://github.com/paritytech/cargo-contract/pull/1306" target="_blank" rel="noopener noreferrer">#1306</a>)</li><li><code>cargo contract info</code> now outputs the language of the deployed contract, using a heuristic (<a href="https://github.com/paritytech/cargo-contract/pull/1329" target="_blank" rel="noopener noreferrer">#1329</a>)</li><li><code>cargo contract info --binary</code>: outputs the on-chain Wasm of the contract (<a href="https://github.com/paritytech/cargo-contract/pull/1311/" target="_blank" rel="noopener noreferrer">#1311</a>)</li><li><code>cargo contract info --all</code>: displays all addresses of deployed contracts on a particular chain (<a href="https://github.com/paritytech/cargo-contract/pull/1319" target="_blank" rel="noopener noreferrer">#1319</a>)</li><li><code>cargo contract storage</code>: displays the storage of an on-chain contract (<a href="https://github.com/paritytech/cargo-contract/pull/1395" target="_blank" rel="noopener noreferrer">#1395</a>, <a href="https://github.com/paritytech/cargo-contract/pull/1414" target="_blank" rel="noopener noreferrer">#1414</a>)</li></ul><img loading="lazy" src="/img/contract-storage.png" class="img_ev3q"><h3 class="anchor anchorWithStickyNavbar_LWe7" id="alternative-off-chain-e2e-testing-backend-support-drink">Alternative off-chain E2E testing backend support: DRink!<a href="#alternative-off-chain-e2e-testing-backend-support-drink" class="hash-link" aria-label="Enlace directo al Alternative off-chain E2E testing backend support: DRink!" title="Enlace directo al Alternative off-chain E2E testing backend support: DRink!">​</a></h3><p>DRink! is a toolbox for ink! developers that allows for testing your contracts
without any running node. </p><p>It has a number of features that are pretty great:</p><ul><li>deploy and call your contracts synchronously, <em>without any delays</em> related to block production or networking.</li><li>enhanced debugging and call tracing.</li><li>supports <em>arbitrary runtime</em> configurations, including custom chain extensions and runtime calls.</li><li>full control over runtime state, including block number, timestamp, etc.</li></ul><p>See the <a href="https://github.com/inkdevhub/drink" target="_blank" rel="noopener noreferrer">DRink!</a> page for more details.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="contract-verification">Contract Verification<a href="#contract-verification" class="hash-link" aria-label="Enlace directo al Contract Verification" title="Enlace directo al Contract Verification">​</a></h3><p>We added a bunch of helpful documentation and <code>cargo-contract</code> commands for
contract verification. <a href="/es/5.x/basics/verification/contract-verification">Read more here</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="we-improved-the-contract-example-illustrating-upgradeable-contracts-via-delegate_call">We improved the contract example illustrating upgradeable contracts via <code>delegate_call</code><a href="#we-improved-the-contract-example-illustrating-upgradeable-contracts-via-delegate_call" class="hash-link" aria-label="Enlace directo al we-improved-the-contract-example-illustrating-upgradeable-contracts-via-delegate_call" title="Enlace directo al we-improved-the-contract-example-illustrating-upgradeable-contracts-via-delegate_call">​</a></h3><p>See <a href="https://github.com/paritytech/ink/tree/master/integration-tests/upgradeable-contracts" target="_blank" rel="noopener noreferrer">here</a>
for the contract example.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="we-made-set_code_hash-generic">We made <code>set_code_hash</code> generic<a href="#we-made-set_code_hash-generic" class="hash-link" aria-label="Enlace directo al we-made-set_code_hash-generic" title="Enlace directo al we-made-set_code_hash-generic">​</a></h3><p>The <code>self.env().set_code_hash()</code> method now accepts the <code>Hash</code> environment type instead
of a concrete <code>[u8; 32]</code>.</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token comment" style="color:#6c6783">// Previously</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">set_code</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token keyword" style="color:#ffcc99">mut</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> code_hash</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token keyword" style="color:#ffcc99">u8</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token number" style="color:#e09142">32</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token namespace" style="opacity:0.7">ink</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token namespace" style="opacity:0.7">env</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">::</span><span class="token function" style="color:#9a86fd">set_code_hash</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token plain">code_hash</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">unwrap_or_else</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token closure-params closure-punctuation punctuation" style="color:#6c6783">|</span><span class="token closure-params">err</span><span class="token closure-params closure-punctuation punctuation" style="color:#6c6783">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token punctuation" style="color:#6c6783">}</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">// Now </span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">pub</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#9a86fd">set_code</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token keyword" style="color:#ffcc99">mut</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> code_hash</span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token class-name">Hash</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">self</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">env</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">set_code_hash</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">&amp;</span><span class="token plain">code_hash</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">unwrap_or_else</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token closure-params closure-punctuation punctuation" style="color:#6c6783">|</span><span class="token closure-params">err</span><span class="token closure-params closure-punctuation punctuation" style="color:#6c6783">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token punctuation" style="color:#6c6783">}</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código al portapapeles" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>More details in <a href="https://github.com/paritytech/ink/pull/1906" target="_blank" rel="noopener noreferrer">#1906</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="buffer-size-can-be-customized">Buffer size can be customized<a href="#buffer-size-can-be-customized" class="hash-link" aria-label="Enlace directo al Buffer size can be customized" title="Enlace directo al Buffer size can be customized">​</a></h3><p>With <a href="https://github.com/paritytech/ink/pull/1869" target="_blank" rel="noopener noreferrer">#1869</a> we added a possibility
of setting a custom static buffer size for ink! to use.</p><p>ink! uses a static buffer for interacting with pallet-contracts, i.e. to move data
between <code>pallet-contracts</code> and a smart contract. The advantage of a static buffer
is that no gas-expensive heap allocations are necessary, all allocations are done
using simple pointer arithmetic.</p><p>The default static buffer size is 16 kB, which is enough for on-chain smart
contracts. However, the <a href="https://phala.network/" target="_blank" rel="noopener noreferrer">Phala Network</a> parachain on Polkadot
allows the deployment of ink! contracts off-chain. Hence, for their chain certain high
computation contracts might require a larger buffer size.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="stabilized-call_runtime">Stabilized <code>call_runtime</code><a href="#stabilized-call_runtime" class="hash-link" aria-label="Enlace directo al stabilized-call_runtime" title="Enlace directo al stabilized-call_runtime">​</a></h3><p>We stabilized <code>call_runtime</code> in <a href="https://github.com/paritytech/ink/pull/1749" target="_blank" rel="noopener noreferrer">#1749</a>.
It can be used to call a runtime dispatchable from an ink! contract.</p><p>You can find a contract example and a comparison with chain extensions
<a href="https://github.com/paritytech/ink/tree/master/integration-tests/call-runtime" target="_blank" rel="noopener noreferrer">here</a>.
We&#x27;ve added an example of how to end-to-end test
<code>call_runtime</code> <a href="https://github.com/paritytech/ink/tree/master/integration-tests/e2e-call-runtime" target="_blank" rel="noopener noreferrer">here</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/paritytech/ink-docs/edit/master/versioned_docs/version-5.x/faq/migrating-from-ink-4-to-5.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Editar esta página</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Navegación de páginas de documentos"><a class="pagination-nav__link pagination-nav__link--prev" href="/es/5.x/faq"><div class="pagination-nav__sublabel">Anterior</div><div class="pagination-nav__label">Preguntas Frequentes</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/es/5.x/faq/migrating-from-ink-3-to-4"><div class="pagination-nav__sublabel">Siguiente</div><div class="pagination-nav__label">Migrating from ink! 3.x to 4.0</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#how-to-upgrade" class="table-of-contents__link toc-highlight">How to upgrade</a></li><li><a href="#compatibility" class="table-of-contents__link toc-highlight">Compatibility</a><ul><li><a href="#cargo-contract-40" class="table-of-contents__link toc-highlight"><code>cargo-contract</code> 4.0</a></li><li><a href="#substrate" class="table-of-contents__link toc-highlight">Substrate</a></li><li><a href="#tooling" class="table-of-contents__link toc-highlight">Tooling</a></li><li><a href="#dependencies" class="table-of-contents__link toc-highlight">Dependencies</a></li><li><a href="#frontend-libraries" class="table-of-contents__link toc-highlight">Frontend Libraries</a></li></ul></li><li><a href="#important-changes" class="table-of-contents__link toc-highlight">Important Changes</a><ul><li><a href="#scale-dependencies-were-moved-to-ink-entrance-crate" class="table-of-contents__link toc-highlight"><code>scale</code> dependencies were moved to <code>ink</code> entrance crate</a></li><li><a href="#wildcard-selectors-only-one-other-message-is-allowed-in-the-contract-besides-the-wildcard-selector" class="table-of-contents__link toc-highlight">Wildcard selectors: only one other message is allowed in the contract besides the wildcard selector</a></li><li><a href="#events-20" class="table-of-contents__link toc-highlight">Events 2.0</a></li><li><a href="#no-more-unchecked-arithmetic" class="table-of-contents__link toc-highlight">No more unchecked arithmetic</a></li><li><a href="#fail-when-decoding-from-storage-and-not-all-bytes-consumed" class="table-of-contents__link toc-highlight">Fail when decoding from storage and not all bytes consumed</a></li><li><a href="#ink_e2e-api-changes" class="table-of-contents__link toc-highlight">ink_e2e API Changes</a></li><li><a href="#new-data-structure-storagevec" class="table-of-contents__link toc-highlight">New Data Structure: <code>StorageVec</code></a></li><li><a href="#fallible-methods-for-lazy-mapping-storagevec" class="table-of-contents__link toc-highlight">Fallible methods for <code>Lazy</code>, <code>Mapping</code>, <code>StorageVec</code></a></li><li><a href="#chain-extension-api-changed--support-for-multiple-chain-extensions" class="table-of-contents__link toc-highlight">Chain Extension API changed + Support for multiple chain extensions</a></li></ul></li><li><a href="#interesting-new-features" class="table-of-contents__link toc-highlight">Interesting New Features</a><ul><li><a href="#end-to-end-testing-with-a-chain-snapshot" class="table-of-contents__link toc-highlight">End-To-End testing with a chain snapshot</a></li><li><a href="#new-lints" class="table-of-contents__link toc-highlight">New lints</a></li><li><a href="#new-cargo-contract-commands" class="table-of-contents__link toc-highlight">New <code>cargo-contract</code> commands</a></li><li><a href="#alternative-off-chain-e2e-testing-backend-support-drink" class="table-of-contents__link toc-highlight">Alternative off-chain E2E testing backend support: DRink!</a></li><li><a href="#contract-verification" class="table-of-contents__link toc-highlight">Contract Verification</a></li><li><a href="#we-improved-the-contract-example-illustrating-upgradeable-contracts-via-delegate_call" class="table-of-contents__link toc-highlight">We improved the contract example illustrating upgradeable contracts via <code>delegate_call</code></a></li><li><a href="#we-made-set_code_hash-generic" class="table-of-contents__link toc-highlight">We made <code>set_code_hash</code> generic</a></li><li><a href="#buffer-size-can-be-customized" class="table-of-contents__link toc-highlight">Buffer size can be customized</a></li><li><a href="#stabilized-call_runtime" class="table-of-contents__link toc-highlight">Stabilized <code>call_runtime</code></a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/es/assets/js/runtime~main.592b5be2.js"></script>
<script src="/es/assets/js/main.3411f81b.js"></script>
</body>
</html>