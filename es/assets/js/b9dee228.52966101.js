"use strict";(self.webpackChunkink_docs=self.webpackChunkink_docs||[]).push([[3066],{83550:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>a,contentTitle:()=>t,default:()=>u,frontMatter:()=>l,metadata:()=>i,toc:()=>c});var r=n(74848),o=n(28453);const l={title:"Selectores",hide_title:!0,slug:"/basics/selectors"},t="Selectores",i={id:"basics/selectors",title:"Selectores",description:"Los selectors en ink! son una forma de lenguaje agn\xf3stico para identificar constructores y mensajes. Son strings hexadecimales de cuatro bytes que se ven asi: 0x633aa551.",source:"@site/i18n/es/docusaurus-plugin-content-docs/version-5.x/basics/selectors.md",sourceDirName:"basics",slug:"/basics/selectors",permalink:"/es/5.x/basics/selectors",draft:!1,unlisted:!1,editUrl:"https://github.com/paritytech/ink-docs/edit/master/versioned_docs/version-5.x/basics/selectors.md",tags:[],version:"5.x",frontMatter:{title:"Selectores",hide_title:!0,slug:"/basics/selectors"},sidebar:"reference",previous:{title:"Eventos",permalink:"/es/5.x/basics/eventos"},next:{title:"Definiciones Trait",permalink:"/es/5.x/basics/definiciones-trait"}},a={},c=[{value:"C\xe1lculo del selector",id:"c\xe1lculo-del-selector",level:2},{value:"C\xe1lculo del selector: Traits de ink!",id:"c\xe1lculo-del-selector-traits-de-ink",level:2}];function d(e){const s={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.h1,{id:"selectores",children:"Selectores"}),"\n",(0,r.jsxs)(s.p,{children:["Los selectors en ink! son una forma de lenguaje agn\xf3stico para identificar constructores y mensajes. Son strings hexadecimales de cuatro bytes que se ven asi: ",(0,r.jsx)(s.code,{children:"0x633aa551"}),"."]}),"\n",(0,r.jsxs)(s.p,{children:["Podemos encontrar el selector de un constructor de ink! o el mensaje en la ",(0,r.jsx)(s.a,{href:"/basics/metadata",children:"metadata del contrato"})," buscando el campo ",(0,r.jsx)(s.code,{children:"selector"})," del dispatchable que nos interese."]}),"\n",(0,r.jsxs)(s.p,{children:["Aqu\xed hay un ejemplo de como se puede elegir el nombre del mensaje y el selector desde la metadata del contrato usando ",(0,r.jsx)(s.a,{href:"https://stedolan.github.io/jq/",children:(0,r.jsx)(s.code,{children:"jq"})}),"."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:'cat target/ink/flipper.json | jq \'.spec.messages[0] | "\\(.label): \\(.selector)"\'\r\n"flip: 0x633aa551"\n'})}),"\n",(0,r.jsx)(s.h2,{id:"c\xe1lculo-del-selector",children:"C\xe1lculo del selector"}),"\n",(0,r.jsx)(s.p,{children:"Si no se tiene acceso a la metadata del contrato uno puede calcularlo por si mismo."}),"\n",(0,r.jsx)(s.p,{children:"El algoritmo que ink! usa es bastante directo:"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["Obtener ",(0,r.jsx)(s.em,{children:"solo"})," el nombre del constructor o el mensaje"]}),"\n",(0,r.jsxs)(s.li,{children:["Computar el hash ",(0,r.jsx)(s.code,{children:"BLAKE2"})," del nombre"]}),"\n",(0,r.jsx)(s.li,{children:"Tomar los primeros cuatro bytes del hash como selector"}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Vamos a dar un breve ejemplo de c\xf3mo se ve en la pr\xe1ctica. Considerar el siguiente mensaje:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-rust",children:"#[ink(message)]\r\nfn frobinate(&mut self, fro: bool, bi: u32, nate: AccountId) -> bool {\r\n    unimplemented!()\r\n}\n"})}),"\n",(0,r.jsx)(s.p,{children:"Para calcular el selector:"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["Tomar el nombre del mensaje, ",(0,r.jsx)(s.code,{children:"frobinate"})]}),"\n",(0,r.jsxs)(s.li,{children:["Computar ",(0,r.jsx)(s.code,{children:'BLAKE2("frobinate") = 0x8e39d7f22ef4f9f1404fe5200768179a8b4f2b67799082d7b39f6a8ca82da8f1'})]}),"\n",(0,r.jsxs)(s.li,{children:["Tomar los primeros cuatro bytes, ",(0,r.jsx)(s.code,{children:"0x8e39d7f2"})]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"c\xe1lculo-del-selector-traits-de-ink",children:"C\xe1lculo del selector: Traits de ink!"}),"\n",(0,r.jsxs)(s.p,{children:["Estas reglas cambian un poco si se define cualquier mensaje usando el ",(0,r.jsx)(s.code,{children:"[ink::trait_definition]"})," ",(0,r.jsx)(s.a,{href:"/basics/trait-definitions",children:"macro"}),".\r\nPara el primer paso, en lugar de tomar el nombre del mensaje ",(0,r.jsx)(s.em,{children:"justo"})," , ahora agregamos adem\xe1s el ",(0,r.jsx)(s.em,{children:"nombre del trait"})," para el c\xe1lculo del selector."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:'cat target/ink/trait-flipper.json | jq \'.spec.messages[0] | "\\(.label): \\(.selector)"\'\r\n"Flip::flip: 0xaa97cade"\n'})}),"\n",(0,r.jsx)(s.p,{children:"Veamos c\xf3mo se ver\xeda \xe9sto en la pr\xe1ctica. Consideremos el siguiente trait:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-rust",children:"#[ink::trait_definition]\r\npub trait Frobinate {\r\n    fn frobinate(&mut self, fro: bool, bi: u32, nate: AccountId) -> bool;\r\n}\r\n\r\n-- snip --\r\n\r\nimpl Frobinate for Contract {\r\n    #[ink(message)]\r\n    fn frobinate(&mut self, fro: bool, bi: u32, nate: AccountId) -> bool {\r\n        unimplemented!()\r\n    }\r\n}\n"})}),"\n",(0,r.jsx)(s.p,{children:"Para calcular el selector:"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["Tomar el nombre del trait ",(0,r.jsx)(s.strong,{children:"y"})," el nombre del mensaje, ",(0,r.jsx)(s.code,{children:"Frobinate::frobinate"})]}),"\n",(0,r.jsxs)(s.li,{children:["Computar ",(0,r.jsx)(s.code,{children:'BLAKE2("Frobinate::frobinate") = 0x8915412ad772b2a116917cf75df4ba461b5808556a73f729bce582fb79200c5b'})]}),"\n",(0,r.jsxs)(s.li,{children:["Tomar los primeros cuatro bytes, ",(0,r.jsx)(s.code,{children:"0x8915412a"})]}),"\n"]}),"\n",(0,r.jsx)(s.admonition,{type:"tip",children:(0,r.jsxs)(s.p,{children:["No preocuparse si no se puede calcular el hash de un string ",(0,r.jsx)(s.code,{children:"BLAKE2"})," a mano. Se puede usar la ",(0,r.jsx)(s.a,{href:"https://www.shawntabrizi.com/substrate-js-utilities/",children:"utilidad de Substrate de Shawn"})," para que lo haga por uno!"]})})]})}function u(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>t,x:()=>i});var r=n(96540);const o={},l=r.createContext(o);function t(e){const s=r.useContext(l);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:t(e.components),r.createElement(l.Provider,{value:s},e.children)}}}]);